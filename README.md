# VbaDevelopSupport
 VBA開発支援アドイン



## これは

VBEに機能を追加して、VBA開発を楽にするためのアドインです。

※ただしExcel専用

![](https://www.dropbox.com/s/oxelvdekh71wbu1/preview.png?raw=1)



## 使い方

アドインを実行するとメニューバーに「VBE開発支援」が増えるので、このコマンドを実行するだけ。

ただし、いずれのコマンドもアクティブなプロジェクトに対して実行されるので、処理したいプロジェクトのモジュールを開いてしっかり切り替えておくことを忘れずに。



## 機能一覧

* ソースをバックアップとエクスポートする
* ソースをSRCにエクスポートする
* ソースをYYYYMMDエクスポートする
* ソースコードのプロシージャ一覧を出力する
* 全てのコードウインドウを閉じる
* イミディエイトウィンドウを空にする
* VBA開発支援アドインを終了する



## エクスポートの基本ルール

### 拡張子

ソースコードの拡張子は`.vba`です。

理由は次の通り

* 汎用エディタの関連付けを便利にするため。

* GitHubの自動言語判定でVBAと認識させるため。
* 拡張子が`.vba`でも、VBEへのインポートには支障がないため。

```
*.bas.vba 標準モジュール
*.cls.vba クラスモジュール／Sheet・Bookモジュール
*.frm.vba フォームモジュール
*.frm.frx フォームモジュールのバイナリ部分
```



### 除外ルール

一部のモジュールはエクスポートされません。

* 白紙のモジュール
* `Option Explicit`などの`Option`しか書かれていないモジュール
* 及び改行しか書かれていないモジュール

これは、Excelの不要なシートモジュールの出力を防ぐためです。



## ソースをバックアップとエクスポートする

`../src`にソースコードをエクスポートしつつ、バージョン管理フォルダにコピーします。

GitHub、WinMerge両方で管理したい場合におすすめです。

あらかじめマクロブックは`bin`フォルダに格納してください。

次のフォルダ構成になるように出力します。

```
/bin/AddinName.xlam
/src/CodeName.bas.vba
/backup/bin/YYYYMMDD_HHMMSS_AddinName.xlam
/backup/src/CodeName.bas.vba
```

※一旦、srcにエクスポートした後、backupに複製されます。



## ソースをSRCにエクスポートする

`../src`にソースコードをエクスポートします。

GitHubで管理したい場合におすすめです。

あらかじめマクロブックは`bin`フォルダに格納してください。

次のフォルダ構成になるように出力します。

```
/bin/AddinName.xlam
/src/CodeName.bas.vba
```

※一旦srcフォルダごと削除してからエクスポートするため、大事なファイルをここに入れると消されます。



## ソースをYYYYMMDDにエクスポートする

マクロブックのあるフォルダに、日付フォルダを作成してソースコードをエクスポートします。

WinMergeによるバージョン管理をする場合におすすめです。

### 【はい】を選んだ場合

一日に1回しか出力しない場合に。

```
/AddinName.xlam
/20200801/CodeName.bas.vba
```

### 【いいえ】を選んだ場合

一日に何度も出力する場合に。

```
/AddinName.xlam
/20200801_082046/CodeName.bas.vba
```



## ソースコードのプロシージャ一覧を出力する

プロシージャ1件あたり1行となるように、新規エクセルブックにテーブル形式で出力します。

参考：https://qiita.com/Mikoshiba_Kyu/items/46b7243eb576848b3e55

### ユースケース

* 関数をデータベース化する場合
* 関数名の`Public/Private`つけ忘れをチェックする場合（テーブル右端参考）
* 引数や戻り値の型の統一をする場合



## VbeDevelop.basについて

検証で使ったものや、ネットからコピペしたものなど、ソースコードがぐちゃぐちゃです。

お宝が隠れてるかも・・。



